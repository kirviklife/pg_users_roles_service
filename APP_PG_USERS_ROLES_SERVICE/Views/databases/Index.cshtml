@model APP_PG_USERS_ROLES_SERVICE.Models.SrvData

@{
	ViewData["Title"] = "Index";
}
<div class="row g-3 mb-4 align-items-center justify-content-between">
	<div class="col-auto">
		<a class="btn btn-outline-primary"  asp-action="index" asp-controller="servers">
			<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-circle" viewBox="0 0 16 16">
				<path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8zm15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-4.5-.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5z" />
			</svg> Вернуться
		</a>
	</div>
	<div class="col-auto">
		<div class="page-utilities">
			<div class="row g-2 justify-content-start justify-content-md-end align-items-center">
				<div class="col-auto">
					<h1 class="app-page-title mb-0">Данные сервера <u><b>@ViewBag.Srv_Name</b></u></h1>
					
				</div>
			</div><!--//row-->
		</div><!--//table-utilities-->
	</div><!--//col-auto-->
</div><!--//row-->
	
<div class="row gy-4">
	<div class="col-12 col-lg-7">
		<div class="app-card app-card-account shadow-sm d-flex flex-column align-items-start">
			<div class="app-card-header p-3 border-bottom-0">
				<div class="row align-items-center gx-3">
					<div class="col-auto">
						<div class="app-icon-holder">
							<svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-people" viewBox="0 0 16 16">
								<path d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8Zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816ZM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z" />
							</svg>
						</div><!--//icon-holder-->

					</div><!--//col-->
					<div class="col-auto">
						<h4 class="app-card-title">Пользователи</h4>
					</div><!--//col-->
					<div class="col-auto">
						@Html.TextBox("SearchUser","",new { @class="form-control", placeholder="Поиск по пользователям..."})
					</div><!--//col-->
				</div><!--//row-->
			</div><!--//app-card-header-->
			<div class="app-card-body px-4 w-100">
				<div class="item border-bottom py-3" style="min-height: 200px;max-height: 200px; overflow-y:auto;-webkit-overflow-scrolling: touch;">
					<table class="table">
						<thead>
							<tr>
								<th>
									Код роли (OID)
								</th>
								<th>
									Имя роли
								</th>
								<th>
									ФИО
								</th>
								<th></th>
							</tr>
						</thead>
						<tbody id="UserDataSearching">
							@foreach (var item in Model.srv_roles_relations.Where(r => r.roles.is_login == true))
							{
								<tr>
									<td>
										@Html.DisplayFor(modelItem => item.oid_roles)
									</td>
									<td>
										@Html.DisplayFor(modelItem => item.roles.role_name)
									</td>
									<td>
										@Html.DisplayFor(modelItem => item.roles.fam) @Html.DisplayFor(modelItem => item.roles.im) @Html.DisplayFor(modelItem => item.roles.otch)
									</td>
									<td>
										<a asp-action="Edit" asp-route-id="@item.roles.id_role" style="color: darkorange">
											<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-pen" viewBox="0 0 16 16">
												<path d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z" />
											</svg>
										</a>
										<a asp-action="Delete" asp-route-id="@item.roles.id_role" style="color: darkred">
											<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-x-octagon" viewBox="0 0 16 16">
												<path d="M4.54.146A.5.5 0 0 1 4.893 0h6.214a.5.5 0 0 1 .353.146l4.394 4.394a.5.5 0 0 1 .146.353v6.214a.5.5 0 0 1-.146.353l-4.394 4.394a.5.5 0 0 1-.353.146H4.893a.5.5 0 0 1-.353-.146L.146 11.46A.5.5 0 0 1 0 11.107V4.893a.5.5 0 0 1 .146-.353L4.54.146zM5.1 1 1 5.1v5.8L5.1 15h5.8l4.1-4.1V5.1L10.9 1H5.1z" />
												<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
											</svg>
										</a>
									</td>
								</tr>
							}
						</tbody>
					</table>
				</div><!--//item-->
			</div><!--//app-card-body-->
			<div class="app-card-footer p-4 mt-auto">
				<a class="btn app-btn-secondary" href="#">Обновить данные с сервера</a>
				<a class="btn app-btn-secondary" href="#">Добавить пользователя</a>
			</div><!--//app-card-footer-->

		</div><!--//app-card-->
	</div><!--//col-->
	<div class="col-12 col-lg-5">
		<div class="app-card app-card-account shadow-sm d-flex flex-column align-items-start" >
			<div class="app-card-header p-3 border-bottom-0">
				<div class="row align-items-center gx-3">
					<div class="col-auto">
						<div class="app-icon-holder">
							<svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-person-gear" viewBox="0 0 16 16">
								<path d="M11 5a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM8 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm.256 7a4.474 4.474 0 0 1-.229-1.004H3c.001-.246.154-.986.832-1.664C4.484 10.68 5.711 10 8 10c.26 0 .507.009.74.025.226-.341.496-.65.804-.918C9.077 9.038 8.564 9 8 9c-5 0-6 3-6 4s1 1 1 1h5.256Zm3.63-4.54c.18-.613 1.048-.613 1.229 0l.043.148a.64.64 0 0 0 .921.382l.136-.074c.561-.306 1.175.308.87.869l-.075.136a.64.64 0 0 0 .382.92l.149.045c.612.18.612 1.048 0 1.229l-.15.043a.64.64 0 0 0-.38.921l.074.136c.305.561-.309 1.175-.87.87l-.136-.075a.64.64 0 0 0-.92.382l-.045.149c-.18.612-1.048.612-1.229 0l-.043-.15a.64.64 0 0 0-.921-.38l-.136.074c-.561.305-1.175-.309-.87-.87l.075-.136a.64.64 0 0 0-.382-.92l-.148-.045c-.613-.18-.613-1.048 0-1.229l.148-.043a.64.64 0 0 0 .382-.921l-.074-.136c-.306-.561.308-1.175.869-.87l.136.075a.64.64 0 0 0 .92-.382l.045-.148ZM14 12.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0Z" />
							</svg>
						</div><!--//icon-holder-->

					</div><!--//col-->
					<div class="col-auto">
						<h4 class="app-card-title">Роли</h4>
					</div><!--//col-->
					<div class="col-auto">
						@Html.TextBox("SearchRole","",new { @class="form-control", placeholder="Поиск по ролям..."})
					</div><!--//col-->
				</div><!--//row-->
			</div><!--//app-card-header-->
			<div class="app-card-body px-4 w-100">
				<div class="item border-bottom py-3" style="max-height: 200px; overflow-y:auto;-webkit-overflow-scrolling: touch;">
					<table class="table">
						<thead>
							<tr>
								<th>
									Код роли (OID)
								</th>
								<th>
									Имя роли
								</th>
								<th></th>
							</tr>
						</thead>
						<tbody id="RoleDataSearching">
							@foreach (var item in Model.srv_roles_relations.Where(r => r.roles.is_login == false))
							{
								<tr>
									<td>
										@Html.DisplayFor(modelItem => item.oid_roles)
									</td>
									<td>
										@Html.DisplayFor(modelItem => item.roles.role_name)
									</td>

									<td>
										<a asp-action="Edit" asp-route-id="@item.roles.id_role" style="color: darkorange">
											<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-pen" viewBox="0 0 16 16">
												<path d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z" />
											</svg>
										</a>
										<a asp-action="Delete" asp-route-id="@item.roles.id_role" style="color: darkred">
											<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-x-octagon" viewBox="0 0 16 16">
												<path d="M4.54.146A.5.5 0 0 1 4.893 0h6.214a.5.5 0 0 1 .353.146l4.394 4.394a.5.5 0 0 1 .146.353v6.214a.5.5 0 0 1-.146.353l-4.394 4.394a.5.5 0 0 1-.353.146H4.893a.5.5 0 0 1-.353-.146L.146 11.46A.5.5 0 0 1 0 11.107V4.893a.5.5 0 0 1 .146-.353L4.54.146zM5.1 1 1 5.1v5.8L5.1 15h5.8l4.1-4.1V5.1L10.9 1H5.1z" />
												<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
											</svg>
										</a> 
									</td>
								</tr>
							}
						</tbody>
					</table>
				</div><!--//item-->
			</div><!--//app-card-body-->
			<div class="app-card-footer p-4 mt-auto">
				<a class="btn app-btn-secondary" href="#">Обновить данные с сервера</a>
				<a class="btn app-btn-secondary" href="#">Добавить роль</a>
			</div><!--//app-card-footer-->

		</div><!--//app-card-->
	</div><!--//col-->
	<div class="col-12 col-lg-5">
		<div class="app-card app-card-account shadow-sm d-flex flex-column align-items-start">
			<div class="app-card-header p-3 border-bottom-0">
				<div class="row align-items-center gx-3">
					<div class="col-auto">
						<div class="app-icon-holder">
							<svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-database" viewBox="0 0 16 16">
								<path d="M4.318 2.687C5.234 2.271 6.536 2 8 2s2.766.27 3.682.687C12.644 3.125 13 3.627 13 4c0 .374-.356.875-1.318 1.313C10.766 5.729 9.464 6 8 6s-2.766-.27-3.682-.687C3.356 4.875 3 4.373 3 4c0-.374.356-.875 1.318-1.313ZM13 5.698V7c0 .374-.356.875-1.318 1.313C10.766 8.729 9.464 9 8 9s-2.766-.27-3.682-.687C3.356 7.875 3 7.373 3 7V5.698c.271.202.58.378.904.525C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777A4.92 4.92 0 0 0 13 5.698ZM14 4c0-1.007-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1s-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4v9c0 1.007.875 1.755 1.904 2.223C4.978 15.71 6.427 16 8 16s3.022-.289 4.096-.777C13.125 14.755 14 14.007 14 13V4Zm-1 4.698V10c0 .374-.356.875-1.318 1.313C10.766 11.729 9.464 12 8 12s-2.766-.27-3.682-.687C3.356 10.875 3 10.373 3 10V8.698c.271.202.58.378.904.525C4.978 9.71 6.427 10 8 10s3.022-.289 4.096-.777A4.92 4.92 0 0 0 13 8.698Zm0 3V13c0 .374-.356.875-1.318 1.313C10.766 14.729 9.464 15 8 15s-2.766-.27-3.682-.687C3.356 13.875 3 13.373 3 13v-1.302c.271.202.58.378.904.525C4.978 12.71 6.427 13 8 13s3.022-.289 4.096-.777c.324-.147.633-.323.904-.525Z" />
							</svg>
						</div><!--//icon-holder-->

					</div><!--//col-->
					<div class="col-auto">
						<h4 class="app-card-title">Базы данных</h4>
					</div><!--//col-->
					<div class="col-auto">
						@Html.TextBox("SearchDB","",new { @class="form-control", placeholder="Поиск по БД..."})
					</div><!--//col-->
				</div><!--//row-->
			</div><!--//app-card-header-->
			<div class="app-card-body px-4 w-100">

				<div class="item border-bottom py-3" style="min-height: 200px;max-height: 200px; overflow-y:auto;-webkit-overflow-scrolling: touch;">
					<table class="table">
						<thead>
							<tr>
								<th>
									Код объекта (OID)
								</th>
								<th>
									Имя БД
								</th>
								<th></th>
							</tr>
						</thead>
						<tbody id="DBDataSearching">
							@foreach (var item in Model.databases)
							{
								<tr>

									<td>
										@Html.DisplayFor(modelItem => item.oid_db)
									</td>
									<td>
										@Html.DisplayFor(modelItem => item.db_name)
									</td>
									<td>
										<a asp-action="Details" asp-route-id="@item.id_db">
											<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16">
												<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
												<path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z" />
											</svg>
										</a>
									</td>
								</tr>
							}
						</tbody>
					</table>
					<div id="divLoader" style="display:none; text-align:center"> <img src="~/load.gif" style="height: 110px;" alt="Loader" /> </div>
				</div><!--//item-->
			</div><!--//app-card-body-->
			<div class="app-card-footer p-4 mt-auto">
				<input type="submit" value="Обновить данные с сервера" id="btnupddb" class="btn app-btn-secondary" />
			</div><!--//app-card-footer-->

		</div><!--//app-card-->
	</div><!--//col-->
	<div class="col-12 col-lg-7">
		<div class="app-card app-card-account shadow-sm d-flex flex-column align-items-start">
			<div class="app-card-header p-3 border-bottom-0">
				<div class="row align-items-center gx-3">
					<div class="col-auto">
						<div class="app-icon-holder">
							<svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.5em" fill="currentColor" class="bi bi-key" viewBox="0 0 16 16">
								<path d="M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8zm4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5z" />
								<path d="M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0z" />
							</svg>
						</div><!--//icon-holder-->

					</div><!--//col-->
					<div class="col-auto">
						<h4 class="app-card-title">Соотношение пользователей и ролей</h4>
					</div><!--//col-->
				</div><!--//row-->
			</div><!--//app-card-header-->
			<div class="app-card-body px-4 w-100">
				<div class="item border-bottom py-3" style="max-height: 200px; overflow-y:auto;-webkit-overflow-scrolling: touch;">
					<div id="dvRelRolesAndUsers">
						@{
							Html.RenderPartial("GetUsersRoles", Model.v_users_roles_grants);
						}
					</div>
				</div><!--//item-->
			</div><!--//app-card-body-->
			<div class="app-card-footer p-4 mt-auto">
				<input type="submit" value="Обновить данные с сервера" id="btnupdrelroleuser" class="btn app-btn-secondary" />
				<a class="btn app-btn-secondary" href="#">Добавить пользователя</a>
			</div><!--//app-card-footer-->

		</div><!--//app-card-->
	</div><!--//col-->
</div><!--//row-->




<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
	$(document).ready(function(){
		$("#SearchDB").bind('input', function () {
			var SearchValue = $("#SearchDB").val();
			var SearchID = '@ViewBag.ID_Srv';
			var SetData = $("#DBDataSearching");
			SetData.html("");
			$("#divLoader").show();
			$.ajax({
				type: "post",
				url: "/databases/GetSearchDB?SearchValue=" + SearchValue + "&iddb=" + SearchID,
				contextType: "html",
				success: function (result){
						$.each(result, function(index, value){
							var Data = "'<tr><td>" + value.oid_db + "</td><td>" + value.db_name + "</td><td><a href=\"/databases/Details/" + value.id_db + "\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" fill=\"currentColor\" class=\"bi bi-info-circle\" viewBox=\"0 0 16 16\"><path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z\" /><path d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z\" /></svg></a></td>< /tr>";
						$("#divLoader").hide();
						SetData.append(Data);

						});
					}
			});
		});
		$("#SearchRole").bind('input', function () {
			var SearchValue = $("#SearchRole").val();
			var SearchID = '@ViewBag.ID_Srv';
			var SetData = $("#RoleDataSearching");
			SetData.html("");
			$.ajax({
				type: "post",
				url: "/databases/GetSearchRole?SearchValue=" + SearchValue + "&iddb=" + SearchID,
				contextType: "html",
				success: function (result) {
					$.each(result, function (index, value) {
						var Data = "'<tr><td>" + value.oid_roles + "</td><td>" + value.role_name + "</td><td>"
							+ "<a style=\"color: darkorange\" href=\"/databases/Edit/" + value.id_role + "\">"
								+ "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" fill=\"currentColor\" class=\"bi bi-pen\" viewBox=\"0 0 16 16\">"
								+ "<path d=\"m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z\" />"
							+ "</svg></a>"
							+ "<a style=\"color: darkred\"  href=\"/databases/Delete/" + value.id_role + "\">"
								+ "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" fill=\"currentColor\" class=\"bi bi-x-octagon\" viewBox=\"0 0 16 16\">"
								+ "<path d=\"M4.54.146A.5.5 0 0 1 4.893 0h6.214a.5.5 0 0 1 .353.146l4.394 4.394a.5.5 0 0 1 .146.353v6.214a.5.5 0 0 1-.146.353l-4.394 4.394a.5.5 0 0 1-.353.146H4.893a.5.5 0 0 1-.353-.146L.146 11.46A.5.5 0 0 1 0 11.107V4.893a.5.5 0 0 1 .146-.353L4.54.146zM5.1 1 1 5.1v5.8L5.1 15h5.8l4.1-4.1V5.1L10.9 1H5.1z\" />"
								+ "<path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\" />"
							+ "</svg></a>"
							+"</td>< /tr>";
						SetData.append(Data);
					});
				}
			});
		});
		$("#SearchUser").bind('input', function () {
			var SearchValue = $("#SearchUser").val();
			var SearchID = '@ViewBag.ID_Srv';
			var SetData = $("#UserDataSearching");
			SetData.html("");
			$.ajax({
				type: "post",
				url: "/databases/GetSearchUser?SearchValue=" + SearchValue + "&iddb=" + SearchID,
				contextType: "html",
				success: function (result) {
					$.each(result, function (index, value) {
						var FIO = "";
						if (value.fam != null)
							FIO = value.fam + " " + value.im;
						if (value.otch != null)
							FIO = FIO + " " + value.otch;
						var Data = "'<tr><td>" + value.oid_roles + "</td><td>" + value.role_name + "</td><td>" + FIO + "</td><td>"
							+ "<a style=\"color: darkorange\" href=\"/databases/Edit/" + value.id_role + "\">"
							+ "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" fill=\"currentColor\" class=\"bi bi-pen\" viewBox=\"0 0 16 16\">"
							+ "<path d=\"m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z\" />"
							+ "</svg></a>"
							+ "<a style=\"color: darkred\"  href=\"/databases/Delete/" + value.id_role + "\">"
							+ "<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" fill=\"currentColor\" class=\"bi bi-x-octagon\" viewBox=\"0 0 16 16\">"
							+ "<path d=\"M4.54.146A.5.5 0 0 1 4.893 0h6.214a.5.5 0 0 1 .353.146l4.394 4.394a.5.5 0 0 1 .146.353v6.214a.5.5 0 0 1-.146.353l-4.394 4.394a.5.5 0 0 1-.353.146H4.893a.5.5 0 0 1-.353-.146L.146 11.46A.5.5 0 0 1 0 11.107V4.893a.5.5 0 0 1 .146-.353L4.54.146zM5.1 1 1 5.1v5.8L5.1 15h5.8l4.1-4.1V5.1L10.9 1H5.1z\" />"
							+ "<path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\" />"
							+ "</svg></a>"
							+ "</td>< /tr>";
						SetData.append(Data);
					});
				}
			});
		});
		$("#btnupddb").click(function () {
			var SearchID = '@ViewBag.ID_Srv';
			var SetData = $("#DBDataSearching");
			SetData.html("");
			$("#divLoader").show();
				$.ajax({
				type: "post",
				url: "/databases/GetUpdateDB?iddb=" + SearchID,
				contextType: "html",
				success: function (result) {
					$.each(result, function (index, value) {
						var Data = "'<tr><td>" + value.oid_db + "</td><td>" + value.db_name + "</td><td><a href=\"/databases/Details/" + value.id_db + "\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" fill=\"currentColor\" class=\"bi bi-info-circle\" viewBox=\"0 0 16 16\"><path d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z\" /><path d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z\" /></svg></a></td>< /tr>";
						$("#divLoader").delay(3000).hide();
						SetData.append(Data);
					});
					alertify.set('notifier', 'delay', 2);
					alertify.notify('Данные обновлены!');
				}
			});
		});
		$("#btnupdrelroleuser").click(function () {
			var SearchID = '@ViewBag.ID_Srv';
			$('#dvRelRolesAndUsers').load('@Url.Action("GetUsersRoles", "databases")?id_s=' + SearchID);
			alertify.set('notifier', 'delay', 2);
			alertify.notify('Данные обновлены!');
		});
	});
</script>


















































